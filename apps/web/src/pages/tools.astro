---
// Disable prerendering to check auth on server
export const prerender = false;

import Layout from "@/layouts/Layout.astro";
import Container from "@/components/Container.astro";
import Button from "@/components/ui/Button.astro";
import Icon from "@/components/Icon.astro";
import { SITE } from "@/lib/constants";
import { getSession } from "@/lib/auth-check";

const session = await getSession(Astro.request);

const toolCategories = [
  {
    name: "Storage & Files",
    tools: [
      { title: "Drive", description: "Upload and store any file with S3-backed storage and global CDN delivery.", icon: "folder", href: "/app/drive", status: "free", featured: true },
      { title: "Image Resize", description: "Resize images to any dimension while maintaining quality.", icon: "image", href: "/tools/images/resize", status: "free" },
      { title: "Image Compress", description: "Compress images to reduce file size while maintaining quality.", icon: "compress", href: "/tools/images/compress", status: "free" },
      { title: "Image Convert", description: "Convert images between formats. JPEG, PNG, WebP, AVIF, GIF.", icon: "convert", href: "/tools/images/convert", status: "free" },
    ],
  },
  {
    name: "PDF Tools",
    tools: [
      { title: "Merge PDF", description: "Combine multiple PDF files into a single document.", icon: "merge", href: "#", status: "coming-soon" },
      { title: "Split PDF", description: "Split a PDF into individual pages or extract specific pages.", icon: "split", href: "#", status: "coming-soon" },
      { title: "Compress PDF", description: "Reduce PDF file size while maintaining quality.", icon: "compress", href: "#", status: "coming-soon" },
      { title: "PDF Watermark", description: "Add text watermarks to PDF documents.", icon: "stamp", href: "#", status: "coming-soon" },
    ],
  },
  {
    name: "Media & Downloads",
    tools: [
      { title: "Video Downloader", description: "Download from YouTube, TikTok, Instagram, Twitter, and 100+ platforms.", icon: "video", href: "#", status: "coming-soon", featured: true },
      { title: "Screenshot API", description: "Capture any website programmatically. Full page or viewport.", icon: "camera", href: "#", status: "coming-soon" },
      { title: "QR Code Generator", description: "Generate QR codes for URLs, WiFi, vCards, and more.", icon: "qrcode", href: "/tools/qrcode", status: "free" },
    ],
  },
  {
    name: "Links & Sharing",
    tools: [
      { title: "Short Links", description: "Create short, memorable links with click tracking and analytics.", icon: "link", href: "/app/links", status: "free" },
      { title: "Paste", description: "Share code snippets with syntax highlighting and expiration.", icon: "code", href: "/app/paste", status: "free" },
    ],
  },
  {
    name: "Developer Utilities",
    tools: [
      { title: "JSON Tools", description: "Format, validate, transform JSON. Convert between JSON, YAML, CSV.", icon: "braces", href: "/tools/json", status: "free" },
      { title: "Hash Generator", description: "Generate MD5, SHA-1, SHA-256, SHA-512 hashes. Verify file integrity.", icon: "hash", href: "/tools/hash", status: "free" },
      { title: "Base64", description: "Encode and decode Base64 strings. Support for files and images.", icon: "binary", href: "/tools/base64", status: "free" },
      { title: "UUID Generator", description: "Generate UUIDs v1, v4, v5. Bulk generation and validation.", icon: "key", href: "/tools/uuid", status: "free" },
    ],
  },
];
---

<Layout title={`Tools - ${SITE.TITLE}`} session={session}>
  <div class="divide-y divide-dashed">
    <!-- Hero -->
    <section class="border-t border-dashed">
      <div class="lg:border-x border-dashed md:w-[calc(100%-140px)] mx-auto">
        <Container class="py-24 md:py-32 lg:py-40">
          <div class="flex flex-col gap-10 max-w-3xl mx-auto text-center">
            <div class="space-y-6">
              <h1 class="text-4xl md:text-5xl lg:text-6xl font-medium tracking-tight">
                All Tools
              </h1>
              <p class="text-lg md:text-xl text-muted-foreground leading-relaxed">
                20+ developer tools in one place. Upload files, download videos, shorten URLs, and much more.
              </p>
            </div>
            <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
              <Button href="/signup">
                Get started for free
              </Button>
              <Button href="/pricing" variant="secondary">
                View pricing
              </Button>
            </div>
          </div>
        </Container>
      </div>
    </section>

    <!-- Tools Grid -->
    <section>
      <div class="lg:border-x border-dashed md:w-[calc(100%-140px)] mx-auto">
        <Container class="py-24 space-y-20">
          {toolCategories.map((category) => (
            <div class="space-y-8">
              <h2 class="text-2xl md:text-3xl font-medium">{category.name}</h2>
              <ul class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5">
                {category.tools.map((tool) => (
                  <li>
                    <a
                      href={tool.href}
                      class={`block bg-card p-6 rounded-xl flex flex-col gap-4 h-full transition-all duration-300 ${tool.status === 'coming-soon' ? 'opacity-60 cursor-not-allowed' : 'hover:shadow-lg'}`}
                      {...(tool.status === 'coming-soon' && { onclick: 'event.preventDefault()' })}
                    >
                      <div class="flex items-start justify-between gap-2">
                        <div class="w-11 h-11 rounded-xl bg-muted flex items-center justify-center text-foreground flex-shrink-0">
                          <Icon name={tool.icon} class="w-6 h-6" />
                        </div>
                        <div class="flex flex-wrap gap-1.5 justify-end">
                          {tool.status === 'free' && (
                            <span class="text-xs font-medium text-emerald-600 bg-emerald-50 dark:text-emerald-400 dark:bg-emerald-950 px-2 py-1 rounded-md">
                              Free
                            </span>
                          )}
                          {tool.status === 'pro' && (
                            <span class="text-xs font-medium text-purple-600 bg-purple-50 dark:text-purple-400 dark:bg-purple-950 px-2 py-1 rounded-md">
                              Pro
                            </span>
                          )}
                          {tool.status === 'coming-soon' && (
                            <span class="text-xs font-medium text-muted-foreground bg-muted px-2 py-1 rounded-md">
                              Coming Soon
                            </span>
                          )}
                          {tool.featured && (
                            <span class="text-xs font-medium text-accent bg-accent/10 px-2 py-1 rounded-md">
                              Popular
                            </span>
                          )}
                        </div>
                      </div>
                      <div class="flex-1">
                        <h3 class="text-lg font-semibold mb-2">{tool.title}</h3>
                        <p class="text-muted-foreground text-sm leading-relaxed line-clamp-2">{tool.description}</p>
                      </div>
                    </a>
                  </li>
                ))}
              </ul>
            </div>
          ))}
        </Container>
      </div>
    </section>

    <!-- CTA -->
    <section class="border-b border-dashed">
      <div class="lg:border-x border-dashed md:w-[calc(100%-140px)] mx-auto">
        <Container class="py-24 md:py-32">
          <div class="flex flex-col items-center space-y-8 max-w-3xl mx-auto">
            <div class="space-y-4 text-center">
              <h2 class="relative text-center text-balance text-3xl tracking-tight md:text-4xl lg:text-5xl font-semibold">
                Ready to get started?
              </h2>
              <p class="mx-auto max-w-2xl text-muted-foreground text-lg md:text-xl text-balance leading-relaxed">
                Start using all tools for free. No credit card required.
              </p>
            </div>

            <div class="flex flex-col sm:flex-row w-full items-center justify-center gap-4">
              <Button href="/signup" class="w-full sm:w-auto">
                Get started for free
              </Button>
              <Button href="/pricing" variant="secondary" class="w-full sm:w-auto">
                View pricing
              </Button>
            </div>
          </div>
        </Container>
      </div>
    </section>
  </div>
</Layout>
